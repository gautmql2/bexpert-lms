<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Bexpert LMS Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Subscription Check -->
  <script>
    const isSubscribed =
      localStorage.getItem('hasSubscribedToBexpert') === 'true' ||
      sessionStorage.getItem('hasSubscribedToBexpert') === 'true';
    if (!isSubscribed) {
      window.location.href = "/subscribe.html";
    }
  </script>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script src="/firebase-auth.js"></script>
</head>
<body class="bg-gray-100 min-h-screen flex">

  <!-- Sidebar -->
  <aside class="w-64 bg-white shadow-md p-6 flex flex-col">
    <div class="text-2xl font-bold text-blue-600 text-center mb-6">Bexpert LMS</div>
    <nav class="flex-1 space-y-4 text-gray-700">
      <a href="/protected/dashboard.html" class="block px-4 py-2 hover:bg-blue-100 rounded">ğŸ“Š Dashboard</a>
      <a href="/protected/course1.html" class="block px-4 py-2 hover:bg-blue-100 rounded">ğŸ“š Courses</a>
      <a href="#" class="block px-4 py-2 hover:bg-blue-100 rounded">ğŸ¥ Live Sessions</a>
      <a href="/protected/project1.html" class="block px-4 py-2 hover:bg-blue-100 rounded">ğŸ’¼ Projects</a>
      <a href="#" class="block px-4 py-2 hover:bg-blue-100 rounded">ğŸ“ Assignments</a>
      <a href="#" class="block px-4 py-2 hover:bg-blue-100 rounded">ğŸ“ Certificates</a>
    </nav>
    <button onclick="logout()" class="mt-6 bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded">Logout</button>
  </aside>

  <!-- Main Content -->
  <main class="flex-1 p-8">
    <header class="flex justify-between items-center mb-6">
      <h1 class="text-3xl font-semibold">Welcome to Bexpert LMS</h1>
      <div class="text-gray-500 text-sm">Logged in as: <span id="user-email">Loading...</span></div>
    </header>

    <section class="bg-white rounded-lg shadow p-6 mb-6">
      <h2 class="text-xl font-bold mb-4">ğŸ“˜ Excel Mastery - Basics</h2>
      <div class="w-full aspect-video mb-4">
        <iframe class="w-full h-full rounded" src="https://www.youtube.com/embed/YOUR_VIDEO_ID_HERE" title="Excel Video" frameborder="0" allowfullscreen></iframe>
      </div>
      <button class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded">Mark as Complete</button>
    </section>
  </main>

  <!-- Firebase Auth Protection -->
  <script>
    firebase.auth().onAuthStateChanged((user) => {
      if (!user) {
        alert("You must be logged in.");
        window.location.href = "/";
      } else {
        document.getElementById("user-email").textContent = user.email;
      }
    });

    function logout() {
      firebase.auth().signOut().then(() => {
        localStorage.removeItem('hasSubscribedToBexpert');
        sessionStorage.removeItem('hasSubscribedToBexpert');
        alert("You have been logged out.");
        window.location.href = "/";
      }).catch((error) => {
        alert("Logout failed: " + error.message);
      });
    }
  </script>
</body>
</html>
<script type="module" src="/protected/assets/logout.js"></script>
